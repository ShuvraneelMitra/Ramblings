---
layout: post
title: "Codeforces 1777B: Emordnilap"
date: 2025-11-07
categories: [Programming]
description: "Just did contribution problems, look what I found!"
---

> Given a permutation $p$ of $n$ numbers, we create an array $a$ consisting of $2n$ numbers, which is equal to $p$ concatenated with its
> reverse. We then define the beauty of $p$ as the number of inversions in $a$. Your task is to find the sum of beauties of all $n!$ 
> permutations of size $n$. Print the remainder we get when dividing this value by $1000000007$.

Let us call the reverse of $p$ as $\operatorname {rev}(p)$, then we notice that if $0\leq i \lt j \lt 2n$ form an inversion in $a$ then either one of these three cases must occur: 

- $i \in p, \quad j \in p$
- $i \in p, \quad j \in \operatorname {rev}(p)$
- $i \in \operatorname {rev}(p), \quad j \in \operatorname {rev}(p)$

Since we are going to iterate over all permutations of $p$, we note that the first and third cases are exactly the same and we write, considering $\operatorname{inv}(p)$ to be the number of inversions in $p$, and $\pi(\cdot)$ being the set of all permutations of an array: 

$$\operatorname{inv}(a) = \operatorname{inv}(p) + \operatorname {inv}(\operatorname {rev}(p)) + \dfrac{n(n-1)}{2}$$

Summing over all the $n!$ permutations of $p = $ {$1 \dots n$} we get 

$$\displaystyle \sum\operatorname{inv}(a) = \sum\operatorname{inv}(p) + \sum\operatorname {inv}(\operatorname {rev}(p)) + n!\cdot\dfrac{n(n-1)}{2}$$

$$=2\sum\operatorname{inv}(p) + n!\cdot\dfrac{n(n-1)}{2}$$

Now the task of finding the sum of the number of inversions over all permutations of [1...n] is left for the reader as an exercise.